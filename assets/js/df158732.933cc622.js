"use strict";(self.webpackChunkkubewarden_docusaurus=self.webpackChunkkubewarden_docusaurus||[]).push([[9748],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:a,o[1]=s;for(var p=2;p<r;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8155:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var i=n(7462),a=(n(7294),n(3905));const r={sidebar_label:"Limitations",title:"Audit Scanner - Limitations"},o=void 0,s={unversionedId:"explanations/audit-scanner/limitations",id:"explanations/audit-scanner/limitations",title:"Audit Scanner - Limitations",description:"Supported event types",source:"@site/docs/explanations/audit-scanner/limitations.md",sourceDirName:"explanations/audit-scanner",slug:"/explanations/audit-scanner/limitations",permalink:"/explanations/audit-scanner/limitations",draft:!1,editUrl:"https://github.com/kubewarden/docs/edit/main/docs/explanations/audit-scanner/limitations.md",tags:[],version:"current",lastUpdatedAt:1696603701,formattedLastUpdatedAt:"Oct 6, 2023",frontMatter:{sidebar_label:"Limitations",title:"Audit Scanner - Limitations"},sidebar:"docs",previous:{title:"What's it?",permalink:"/explanations/audit-scanner/"},next:{title:"Policy Reports",permalink:"/explanations/audit-scanner/policy-reports"}},l={},p=[{value:"Supported event types",id:"supported-event-types",level:2},{value:"Policies relying on user and user group information",id:"policies-relying-on-user-and-user-group-information",level:2},{value:"Policies relying on external data",id:"policies-relying-on-external-data",level:2},{value:"Usage of <code>*</code> by policies",id:"usage-of--by-policies",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"supported-event-types"},"Supported event types"),(0,a.kt)("p",null,"Policies can inspect ",(0,a.kt)("inlineCode",{parentName:"p"},"CREATE"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"UPDATE"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"DELETE")," events."),(0,a.kt)("p",null,"The audit scanner cannot simulate ",(0,a.kt)("inlineCode",{parentName:"p"},"UPDATE")," events, as it doesn't know exactly\nwhich part of the resource needs to be changed in a meaningful way."),(0,a.kt)("p",null,"Because of that, policy interested only in ",(0,a.kt)("inlineCode",{parentName:"p"},"UPDATE")," events will be ignored by\nthe audit scanner."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The audit-scanner v1.7.0 release supports only ",(0,a.kt)("inlineCode",{parentName:"p"},"CREATE")," events. ",(0,a.kt)("inlineCode",{parentName:"p"},"DELETE")," ones\nwill be handled in the near future.")),(0,a.kt)("h2",{id:"policies-relying-on-user-and-user-group-information"},"Policies relying on user and user group information"),(0,a.kt)("p",null,"Each Kubernetes admission request object contains information about which user\n(or ServiceAccount) initiated the event, and to which group they belong."),(0,a.kt)("p",null,"All the events simulated by the audit scanner are originated by the same hard\ncoded user and group. Because of that, policies that rely on these values to\nmake their decisions will not produce meaningful results."),(0,a.kt)("p",null,"For these cases, the policy should be configured to be skipped from the audit\nchecks."),(0,a.kt)("h2",{id:"policies-relying-on-external-data"},"Policies relying on external data"),(0,a.kt)("p",null,"Policies can request and use external data when performing an evaluation. These\npolicies can be evaluated by the audit checks, but their outcome can change\nover time depending on the external data."),(0,a.kt)("h2",{id:"usage-of--by-policies"},"Usage of ",(0,a.kt)("inlineCode",{parentName:"h2"},"*")," by policies"),(0,a.kt)("p",null,"Both the ",(0,a.kt)("inlineCode",{parentName:"p"},"AdmissionPolicy")," and the ",(0,a.kt)("inlineCode",{parentName:"p"},"ClusterAdmissionPolicy")," custom resources have the following fields:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'spec:\n  rules:\n    - apiGroups: [""]\n      apiVersions: ["v1"]\n      resources: ["pods"]\n      operations:\n        - CREATE\n        - UPDATE\n')),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"apiGroups"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"apiVersions")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"resources")," attributes can use the special ",(0,a.kt)("inlineCode",{parentName:"p"},"*")," inside of them. This is a wildcard\nsymbol that causes the policy to match all the values used inside of the field."),(0,a.kt)("p",null,"Policies that make use of the ",(0,a.kt)("inlineCode",{parentName:"p"},"*")," symbol are going to be ignored by the audit scanner."))}d.isMDXComponent=!0}}]);